spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      routes:
        # ── Ingestion Service ──
        - id: ingestion-service
          uri: ${INGESTION_SERVICE_URL:http://localhost:8085}
          predicates:
            - Path=/ingest/**
          filters:
            - name: CircuitBreaker
              args:
                name: ingestionCB
                fallbackUri: forward:/fallback

        # ── Search Orchestrator (future) ──
        - id: search-orchestrator
          uri: ${SEARCH_ORCHESTRATOR_URL:http://localhost:8081}
          predicates:
            - Path=/search/**
          filters:
            - name: CircuitBreaker
              args:
                name: searchCB
                fallbackUri: forward:/fallback

server:
  port: ${GATEWAY_PORT:8080}

# Resilience4j Config
resilience4j:
  timelimiter:
    configs:
      default:
        timeoutDuration: 60s

management:
  endpoints:
    web:
      exposure:
        include: health,gateway
  endpoint:
    gateway:
      enabled: true

logging:
  level:
    org.springframework.cloud.gateway: TRACE
    org.springframework.http.server.reactive: DEBUG
    org.springframework.web.reactive: DEBUG
    reactor.netty: DEBUG
